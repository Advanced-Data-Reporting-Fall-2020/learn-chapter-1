---
title: "Introduction to R"
description: "Functions, syntax, directories, workspace, libraries"
author: "Andrew Ba Tran"
date: 2018-05-27T21:13:14-05:00
categories: ["R"]
tags: ["R", "introduction"]
weight: 2
slug: intro-to-r
---



<div id="important-points-about-r" class="section level2">
<h2>Important points about R</h2>
<ul>
<li><em>Functions</em> run everything</li>
<li><em>Functions</em> manipulate <strong>objects</strong>
<ul>
<li>An <strong>object</strong> is anything that can be assigned to a variable name via <code>&lt;-</code>operator</li>
<li>This includes data structures, graphs, constants, and also other functions</li>
</ul></li>
<li>All objects have a <strong>class</strong> which can affect how functions handle them</li>
</ul>
</div>
<div id="syntax" class="section level2">
<h2>Syntax</h2>
<p>You must follow pretty specific syntax rules for it to work. It won’t guess for you.</p>
<ul>
<li>R is a case-sensitive interpreted language</li>
<li>Can enter commands at prompt <code>&gt;</code> or in batch</li>
<li>Comments are preceded by <code>#</code></li>
<li>This is important to use often in your code for documentation</li>
<li>You’ll see it often in this course</li>
<li>Statements are lines of code such as functions and object assigments
<ul>
<li>Enters in code or semi-colons will separate statements</li>
</ul></li>
</ul>
</div>
<div id="working-directories" class="section level2">
<h2>Working directories</h2>
<p>Your <em>working directory</em> is the folder on your computer in which you are currently working. When you ask R to open a certain file, it will look in the working directory for this file, and when you tell R to save a data file or figure, it will save it in the working directory.</p>
<p>Before you start working, please set your working directory tow here all your data and script files are or should be stored.</p>
<p>Type in the command window:</p>
<pre class="r"><code># On a mac, it&#39;d look like this
setwd(&quot;~/projects/learn-r-journalism&quot;)

# On a pc, it might look like this
setwd(&quot;C:/Documents/learn-r-journalism&quot;)</code></pre>
<p>{{% notice note %}} Make sure that slashes are forward slashes and that you don’t forget the quotation marks. {{% /notice %}}</p>
<p>Within RStudio, you can also set the working directory via the menu <em>Tools &gt; Set Working Directory</em></p>
<p><img src="/how_to_use_r/intro_to_r/images/setwd.png" alt="Set working directory", class="shadow", style="width:70%"></p>
</div>
<div id="libraries" class="section level2">
<h2>Libraries</h2>
<p>R can do many statistical and data analyses.</p>
<p>They are organized in so-called <em>packages</em> or <em>libraries</em>. With the standard installation (known as <strong>base</strong>), most common packages are installed.</p>
<p>To get a list of all installed packages, go to the packages window or type <code>library()</code> in the console window. If the box in front of the package name is ticked in the packages window, the package is loaded and the functions within it are ready to be called.</p>
<p>There are many more packages available on the R website. If you want to install and use a package (for example, the packaged called “dplyr”) you should:</p>
<ul>
<li>Install the package: click <code>install packages</code> in the packages window and type <code>dplyr</code> or type <code>install.packages(&quot;dplyr&quot;)</code> in the command window.</li>
<li>Load the package: Check box in front of <code>dplyr</code> or type <code>library(&quot;dplyr&quot;)</code> in the command window.</li>
</ul>
</div>
<div id="examples-of-r-commands" class="section level1">
<h1>Examples of R commands</h1>
<div id="calculator" class="section level2">
<h2>Calculator</h2>
<p>R can be used as a calculator.</p>
<p>Just type an equation in the command window after the <code>&gt;</code></p>
<p>{{% notice note %}} In those code sections, the code preceeded by ## is the output of the code from the lines above. {{% /notice %}}</p>
<pre class="r"><code>10^2 + 26</code></pre>
<pre><code>## [1] 126</code></pre>
</div>
<div id="workspace" class="section level2">
<h2>Workspace</h2>
<p>You can give numbers a name.</p>
<p>By doing so, they become so-called variables which can be used later.</p>
<pre class="r"><code>a &lt;- 4
a</code></pre>
<pre><code>## [1] 4</code></pre>
<p>You can do calculations with <code>a</code> now.</p>
<pre class="r"><code>a*5</code></pre>
<pre><code>## [1] 20</code></pre>
<p>If you specify <code>a</code> again, it will forget what value you had before because you did not assign it to anything.</p>
<pre class="r"><code>a</code></pre>
<pre><code>## [1] 4</code></pre>
<p>You can also assign a value to <code>a</code> using the old one</p>
<pre class="r"><code>a &lt;- a + 10
a</code></pre>
<pre><code>## [1] 14</code></pre>
<p>To remove all variables from R’s memory, type</p>
<pre class="r"><code>rm(list=ls())</code></pre>
<p>or click the “clear all” broom button in the workspace window.</p>
<p><img src="/how_to_use_r/intro_to_r/images/clear_objects.png" alt="Set working directory", class="shadow", style="width:70%"></p>
</div>
<div id="scalars-vectors-and-matrices" class="section level2">
<h2>Scalars, vectors, and matrices</h2>
<p>Like in many other programs, R organizes numbers in <em>scalars</em> (a single number 0-dimensional), <em>vectors</em> (a row of numbers, also called arrays - `-dimensional) and <em>matrices</em> (like a table - 2-dimensional).</p>
<p>The <code>a</code> you defined was scalar.</p>
<p>To define a vector with the numbers 3,4, and 5, you need the function <code>c()</code> which is short for concatenate (or paste together).</p>
<pre class="r"><code>b=c(3,4,5)
b</code></pre>
<pre><code>## [1] 3 4 5</code></pre>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<p>If you would like to compute the mean of all the elements in the vector <code>b</code> from the example above, you could type</p>
<pre class="r"><code>(3+4+5)/3</code></pre>
<pre><code>## [1] 4</code></pre>
<p>But when the vector is very long, this is very boring and time-consuming work.</p>
<p>Thi is why things you do often are automated in so-called <em>functions</em>. Some functions are standard in R or in one of the pakages. You can also program your own functions.</p>
<p>When you use a function to compute a mean, you’ll type</p>
<pre class="r"><code>mean(x=b)</code></pre>
<pre><code>## [1] 4</code></pre>
<p>Whithin the brackets you specify the <em>arguments</em>.</p>
<p>Arguments give extra information to the function. In this case, the argument <em>x</em> says of which set of numbers (vector) the mean should computed (namely of b).</p>
<p>Sometimes the name of the argument is not necessary:</p>
<pre class="r"><code>mean(b)</code></pre>
<pre><code>## [1] 4</code></pre>
<p>Also works.</p>
</div>
<div id="plots" class="section level2">
<h2>Plots</h2>
<p>R can make simple graphics right away.</p>
<pre class="r"><code># rnorm() is a base function that creates random samples from a random distribution

x &lt;- rnorm(100)

# plot() is a base function that charts

plot(x)</code></pre>
<p><img src="/how_to_use_r/intro_to_r/2018-05-27-intro-to-r_files/figure-html/norm_graph-1.png" width="672" /></p>
<ul>
<li>In the first line, 100 random numbers are assigned to the variable x, which becomes a vector by this operation.</li>
<li>In the second line, all these values are plotted in the plot window.</li>
</ul>
</div>
<div id="scripts" class="section level2">
<h2>Scripts</h2>
<p>R is an interpreter that uses a command line based environment.</p>
<p>This means that you have to type commands, rather than use the mouse and menus.</p>
<p>This has the advantage that you do not always have to retype commands.</p>
<p>You can store yoru commands in files, the so-called <em>scripts</em>. These scripts have typically file names with the extension <strong>.R</strong> as in <strong>script.R</strong>.</p>
<p>You can open an editor window to edit these files by clicking <em>File &gt; New</em> or <em>File &gt; Open file…</em></p>
<p>You can run (send to the console window) part of the code by selecting lines and pressing <strong>CTRL+ENTER</strong> or <strong>CMD+ENTER</strong> or click the <em>Run</em> button at the top of the script editor window. If you do not select anything, R will run the line your cursor is on.</p>
<p>You can always run the whole script with the function <code>source()</code></p>
<p>For example, to run the entire saved <strong>script.R</strong> if it’s in the root directory of the working directory, type</p>
<pre class="r"><code>source(&quot;script.R&quot;)</code></pre>
<p>You can also click <em>Run all</em> in the editor window or type <strong>CTRL+SHIFT+S</strong> or <em>CMD+SHIFT+S</em></p>
</div>
<div id="not-available-data" class="section level2">
<h2>Not available data</h2>
<p>When you work with real data, you will encounter missing values because instrumentation failed or because you didn’t want to measure in the weekend.</p>
<p>When a data is <em>not available</em>, you write <code>NA</code> instead of a number.</p>
<pre class="r"><code>j &lt;- c(1,2,NA)</code></pre>
<p>Computing statistics of incomplete data sets is strictly not possible.</p>
<p>maybe the largest value occured during the weekend when you didn’t measure. Therefore, R will say that it doesn’t know what the largest value of <code>j</code> is</p>
<pre class="r"><code>max(j)</code></pre>
<pre><code>## [1] NA</code></pre>
<p>If you don’t mind about the missing data and want to compute the statistics anyway, you can add the argument <code>na.rm=TRUE</code> (Should I remove the <code>NA</code>s? Yes)</p>
<pre class="r"><code>max(j, na.rm=T)</code></pre>
<pre><code>## [1] 2</code></pre>
<p>{{% notice warning %}} <code>NA</code>s will also affect any sort of math if you’re not careful {{% /notice %}}</p>
<pre class="r"><code>sum(j)</code></pre>
<pre><code>## [1] NA</code></pre>
<pre class="r"><code># compared to
sum(j, na.rm=T)</code></pre>
<pre><code>## [1] 3</code></pre>
</div>
</div>
<div id="classes" class="section level1">
<h1>Classes</h1>
<p>We’ve been working so far with numbers.</p>
<p>But sometimes data we work with can be specified as something else, like characters and strings or boolean values like <strong>TRUE</strong> or <strong>FALSE</strong> or dates.</p>
<div id="characters" class="section level2">
<h2>Characters</h2>
<pre class="r"><code>m &lt;- &quot;apples&quot;
m</code></pre>
<pre><code>## [1] &quot;apples&quot;</code></pre>
<p>To tell R that something is a character string, you should type the text between apostrophes, otherwise R will start looking for a defined veriable with the same name.</p>
<pre class="r"><code>n &lt;- pears</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;pears&#39; not found</code></pre>
<p>You can’t do math with characters.</p>
<pre class="r"><code>m + 2</code></pre>
<pre><code>## Error in m + 2: non-numeric argument to binary operator</code></pre>
</div>
<div id="dates" class="section level2">
<h2>Dates</h2>
<p>Dates and times are complicated.</p>
<p>R has to know that 3 o’clock comes after 2:59 and that February has 29 days in some years.</p>
<p>The base way to tell R that something is a date-time combination is with the function <code>strptime()</code></p>
<pre class="r"><code>date1 &lt;- strptime(c(&quot;20100225230000&quot;, &quot;20100226000000&quot;, &quot;20100226010000&quot;), format=&quot;%Y%m%d%H%M%S&quot;)
date1</code></pre>
<pre><code>## [1] &quot;2010-02-25 23:00:00 EST&quot; &quot;2010-02-26 00:00:00 EST&quot;
## [3] &quot;2010-02-26 01:00:00 EST&quot;</code></pre>
<p>A vector is created with <code>c()</code> and the numbers between the quotation marks are strings, because that’s what the <code>strptim()</code> function requires.</p>
<p>That’s followed by the argument <strong>format</strong> that defines how the chracter string should be read. In this instance, the year is denoted first (%Y), then the month (%M) and second (%S). You don’t have to specify all of them, as long as the format corresponds to the character string.</p>
<p>In this course, we’ll be using a less messy way to deal with dates using the package <strong>lubridate</strong>.</p>
<pre class="r"><code># If you don&#39;t currently have the lubridate package installed, uncomment the line below and run it

# install.packages(&quot;lubridate&quot;)

library(lubridate)</code></pre>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     date</code></pre>
<pre class="r"><code>date1 &lt;- ymd_hms(c(&quot;20100225230000&quot;, &quot;20100226000000&quot;, &quot;20100226010000&quot;))</code></pre>
</div>
<div id="factors" class="section level2">
<h2>Factors</h2>
<p>Complicated.</p>
<ul>
<li>Data structure specifying categorical (nominal) or ordered categorical (ordinal) variables</li>
<li>Tells R how to handle that variable in analyses</li>
<li>Very important and misunderstood</li>
<li>Any variable that is categorical or ordinal should usually be stored as a factor.</li>
</ul>
<p>For example, Race might be input as “White”, “Black”, and “Hispanic”</p>
<p>When importing that data in from a spreadsheet, R will most often interpret it as a <strong>Factor</strong>.</p>
<p><img src="/how_to_use_r/intro_to_r/images/sample_df.png" alt="Set working directory", class="shadow", style="width:40%"></p>
<p>Let’s take a look at the structure behind a dataframe I’ve included, called <code>sample_df</code></p>
<pre class="r"><code>str(sample_df)</code></pre>
<pre><code>## &#39;data.frame&#39;:    4 obs. of  4 variables:
##  $ id  : Factor w/ 4 levels &quot;1001&quot;,&quot;1002&quot;,..: 1 2 3 4
##  $ name: chr  &quot;Steve&quot; &quot;Pam&quot; &quot;Jim&quot; &quot;Dwight&quot;
##  $ age : num  26 65 15 7
##  $ race: Factor w/ 3 levels &quot;Black&quot;,&quot;Hispanic&quot;,..: 3 1 3 2</code></pre>
<p>R sees that the <strong>Race</strong> column is a factor variable with three levels.</p>
<pre class="r"><code>levels(sample_df$race)</code></pre>
<pre><code>## [1] &quot;Black&quot;    &quot;Hispanic&quot; &quot;White&quot;</code></pre>
<p>This means that R groups statistics by these levels.</p>
<pre class="r"><code>summary(sample_df$race)</code></pre>
<pre><code>##    Black Hispanic    White 
##        1        1        2</code></pre>
<p>Internally, R stores the integer values 1, 2, and 3, and maps the character strings in alphabetical order to these values. 1=Black, 2=Hispanic, and 3=White.</p>
<p>Why is this important to know?</p>
<p>Journalists are less concerned by factors and will often find themselves converting factors to strings and characters. But when you reach the point that you are wanting to create models and linear regressions then you’ll be happy that it’s an option.</p>
<p>{{% notice important %}} Most odd quirks when it comes to R can be traced back to the fact that R was created by and for statisticians. R has grown a lot since then and the community has helped make it evolve to handle data the way we are more used to. But some habits die hard and are ingrained. {{% /notice %}}</p>
</div>
<div id="integers-numbers" class="section level2">
<h2>Integers &amp; Numbers</h2>
<p>Self-explanatory. Saves as whole numbers or nummbers.</p>
</div>
<div id="converting-between-the-different-types" class="section level2">
<h2>Converting between the different types</h2>
<p>Here’s a warning.</p>
<ul>
<li>You can convert factors into strings.</li>
</ul>
<pre class="r"><code>sample_df$race</code></pre>
<pre><code>## [1] White    Black    White    Hispanic
## Levels: Black Hispanic White</code></pre>
<pre class="r"><code>as.character(sample_df$race)</code></pre>
<pre><code>## [1] &quot;White&quot;    &quot;Black&quot;    &quot;White&quot;    &quot;Hispanic&quot;</code></pre>
<ul>
<li>You can convert strings into factors</li>
</ul>
<pre class="r"><code>sample_df$name</code></pre>
<pre><code>## [1] &quot;Steve&quot;  &quot;Pam&quot;    &quot;Jim&quot;    &quot;Dwight&quot;</code></pre>
<pre class="r"><code>factor(sample_df$name)</code></pre>
<pre><code>## [1] Steve  Pam    Jim    Dwight
## Levels: Dwight Jim Pam Steve</code></pre>
<ul>
<li>You <strong>cannot</strong> convert factors into numbers.</li>
</ul>
<pre class="r"><code>sample_df$id</code></pre>
<pre><code>## [1] 1001 1002 1003 1004
## Levels: 1001 1002 1003 1004</code></pre>
<pre class="r"><code>as.numeric(sample_df$id)</code></pre>
<pre><code>## [1] 1 2 3 4</code></pre>
<p>Because R stores <strong>Factors</strong> as <strong>Integer</strong> values.</p>
<p>You must convert factors into characters first <em>before</em> converting it to numbers.</p>
<p>So you can nest it.</p>
<pre class="r"><code>sample_df$id</code></pre>
<pre><code>## [1] 1001 1002 1003 1004
## Levels: 1001 1002 1003 1004</code></pre>
<pre class="r"><code>as.numeric(as.character(sample_df$id))</code></pre>
<pre><code>## [1] 1001 1002 1003 1004</code></pre>
</div>
</div>
<div id="functions-1" class="section level1">
<h1>Functions</h1>
<p>You can also save code you’ve written that simplifies your process into a function.</p>
<pre class="r"><code>percent_change &lt;- function(first_number, second_number) {
  pc &lt;- (second_number-first_number)/first_number*100
  return(pc)
}

percent_change(100,150)</code></pre>
<pre><code>## [1] 50</code></pre>
<p>This is what’s happening in the code above:</p>
<ul>
<li><strong>percent_change</strong> is the name of the function, and assigned to it is the function <code>function()</code></li>
<li>Two variables are necessary to be passed to this function, <strong>first_number</strong> and <strong>second_number</strong></li>
<li>A new object <code>pc</code> is created using some math calculating percent change from the two variables passed to it</li>
<li>the function <code>return()</code> assigns the result of the math to <code>percent_change</code> from the first line</li>
</ul>
<p>Build enough functions and you can save them as <a href="https://github.com/andrewbtran/muckrakr">your own package</a>.</p>
<p><strong>The important thing about functions</strong> is that they’re programmed by humans.</p>
<p>I constructed this function because that’s how I know that I’ll only include two inputs and that each one will be numeric and that they’ll be in order of first then second.</p>
<p>If you’re working in R and a function you’re using is giving an error, it most likely means there’s something wrong with one or more of the variables you’re passing to the function.</p>
<p>Here’s what happens when I pass a string to my <code>percent_change()</code> function.</p>
<pre class="r"><code>percent_change(&quot;what&quot;, &quot;happens&quot;)</code></pre>
<pre><code>## Error in second_number - first_number: non-numeric argument to binary operator</code></pre>
<p>Sometimes really great R programmers will anticipate errors and catch bad inputs and try to output helpful suggestions instead of a generic error.</p>
<p>This particular error isn’t very explicit. It needs to be interpreted but <strong>you</strong> know that the function needs numbers to work correctly.</p>
<p>New users might not know that intuitively.</p>
<p>And that’s how you’re going to feel when functions you run don’t work.</p>
<p>You’ll have to Google the error or peek into code to see if you can see what it expects and how it might break down thanks to what you’ve passed it.</p>
<p>And it won’t be entirely your fault.</p>
<p>When we’re coding and sharing it for others we can’t anticipate all the ways in which others might want to use it in the future.</p>
<p>Shoot the function writer a message or if you wrote the package, welcome feedback from others.</p>
<p>This is what makes participating in the R community so great. We just want to do better.</p>
</div>
